language: java
os: linux
dist: focal
before_install: chmod +x gradlew
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
  - rm -f  $HOME/.gradle/caches/minecraft/deobfedDeps/providedDummy.jar
  - rm -f  $HOME/.gradle/caches/minecraft/deobfedDeps/compileDummy.jar
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
jdk:
  - openjdk8

jobs:
  fast_finish: true
  include:
    - stage: openjdk8
      name: openjdk8
      install: ./gradlew assemble
      script: ./gradlew build
      
    - stage: openjdk11
      name: openjdk11
      jdk: openjdk11
      install: ./gradlew assemble
      script: ./gradlew build
      
    - stage: openjdk15
      name: openjdk15
      jdk: openjdk15
      install: ./gradlew assemble
      script: ./gradlew build
      
notifications:
  email: false
after_success:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh success $WEBHOOK_URL
after_failure:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh failure $WEBHOOK_URL
